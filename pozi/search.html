<!DOCTYPE html>
<html>
    <head>
        <title>Pozi - Search Widget</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="shortcut icon" href="../theme/app/img/favicon.ico">
        <!-- Ext resources -->
        <link rel="stylesheet" type="text/css" href="../externals/ext/resources/css/ext-all.css">
        <link rel="stylesheet" type="text/css" href="../externals/ext/resources/css/xtheme-gray.css">
        <script type="text/javascript" src="../externals/ext/adapter/ext/ext-base.js"></script>
        <script type="text/javascript" src="../externals/ext/ext-all.js"></script>
    </head>
    <body>
	<div id="combobox"></div>
	<script>
		Ext.onReady(function(){
			Ext.BLANK_IMAGE_URL = "/theme/app/img/blank.gif";

			var search_record_select_handler = function(){
				alert("Selected");
			};

		 	var ds = new Ext.data.JsonStore({
				autoLoad: false, //autoload the data
				root: 'rows',
				baseParams: { config: 'vicmap', lga:'346'},
				fields: [{name: "label"	, mapping:"row.label"},
					{name: "xmini"	, mapping:"row.xmini"},
					{name: "ymini"	, mapping:"row.ymini"},
 					{name: "xmaxi"	, mapping:"row.xmaxi"},
					{name: "ymaxi"	, mapping:"row.ymaxi"},
					{name: "gsns"		, mapping:"row.gsns"},
 					{name: "gsln"		, mapping:"row.gsln"},
 					{name: "idcol"	, mapping:"row.idcol"},
 					{name: "idval"	, mapping:"row.idval"},
 					{name: "ld"		, mapping:"row.ld"}
 				],
				proxy: new Ext.data.ScriptTagProxy({
					url: "http://49.156.17.41/ws/rest/v3/ws_all_features_by_string_and_lga.php"
				})
			});

			var cb = new Ext.form.ComboBox({
						id: 'gtSearchCombobox',
						queryParam: 'query',
						store: ds,
						displayField:'label',
						selectOnFocus: true,
						minChars: 3,
						typeAhead: false,
						renderTo: 'combobox',
						loadingText: 'Loading ...',
						width: 450,
						style: "border: 2px solid #BBBBBB; width: 490px; height: 24px; font-size: 11pt;",
						pageSize:0,
						emptyText:'Start typing an address here ...',
						hideTrigger:true,
						tpl: '<tpl for="."><div class="search-item" style="height: 28px;"><font color="#666666">{ld}</font> : {[values.label.replace(new RegExp( "(" +  Ext.get(\'gtSearchCombobox\').getValue()  + ")" , \'gi\' ), "<b>$1</b>" )]} <br></div></tpl>',
							itemSelector: 'div.search-item',
						listeners: {'select': search_record_select_handler}
			});
		});
	</script>
    </body>
</html>
